---
// Custom theme selector - defaults to dark, auto behaves like dark
---

<starlight-theme-select>
  <label>
    <span class="sr-only">Select theme</span>
    <select>
      <option value="auto">Auto</option>
      <option value="dark">Dark</option>
      <option value="light">Light</option>
    </select>
  </label>
</starlight-theme-select>

<script>
  type Theme = 'auto' | 'light' | 'dark';

  class StarlightThemeSelect extends HTMLElement {
    constructor() {
      super();

      const select = this.querySelector('select');
      if (!select) return;

      // Get stored theme or default to dark
      const stored = localStorage.getItem('starlight-theme') as Theme | null;
      const theme = stored || 'dark';

      // Apply theme
      this.setTheme(theme);
      select.value = theme;

      // Listen for changes
      select.addEventListener('change', (e) => {
        const target = e.target as HTMLSelectElement;
        this.setTheme(target.value as Theme);
      });
    }

    setTheme(theme: Theme) {
      // Auto behaves the same as dark
      const effectiveTheme = theme === 'auto' ? 'dark' : theme;
      document.documentElement.dataset.theme = effectiveTheme;
      localStorage.setItem('starlight-theme', theme);
    }
  }

  customElements.define('starlight-theme-select', StarlightThemeSelect);
</script>

<style>
  label {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    color: var(--sl-color-gray-1);
  }

  select {
    background-color: var(--sl-color-gray-6);
    color: var(--sl-color-gray-1);
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.25rem;
    padding: 0.25rem 0.5rem;
    cursor: pointer;
    font-size: var(--sl-text-xs);
  }

  select:hover {
    border-color: var(--sl-color-gray-3);
  }

  select option {
    background-color: var(--sl-color-gray-6);
    color: var(--sl-color-gray-1);
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
</style>
